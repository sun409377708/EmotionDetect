# 🆓 免费部署方案指南

## ❌ Railway 限制说明
Railway现在对免费用户限制只能部署数据库，需要付费才能部署Web应用。

## ✅ 推荐的免费替代方案

### 🥇 方案1：Render（最推荐）

#### 特点
- ✅ **完全免费**（有使用限制但足够个人项目）
- ✅ **支持Python Flask + TensorFlow**
- ✅ **自动从GitHub部署**
- ✅ **提供HTTPS**
- ⚠️ 月度限制：750小时

#### 部署步骤
1. **访问 https://render.com**
2. **注册并连接GitHub账户**
3. **点击 "New+" → "Web Service"**
4. **选择仓库：`sun409377708/EmotionDetect`**
5. **配置设置**：
   ```
   Name: emotion-detect
   Region: Oregon (US West)
   Branch: main
   Runtime: Python 3
   Build Command: pip install -r requirements.txt
   Start Command: gunicorn web_demo:app --host=0.0.0.0 --port=$PORT
   ```
6. **点击 "Create Web Service"**

#### 预期结果
- 部署时间：5-10分钟
- 获得URL：`https://emotion-detect-xxxx.onrender.com`
- 自动SSL证书

---

### 🥈 方案2：Fly.io

#### 特点
- ✅ **每月免费额度**：$5价值
- ✅ **全球边缘部署**
- ✅ **支持Docker**
- ✅ **自动扩缩容**

#### 部署步骤
1. **安装Fly CLI**：
   ```bash
   # macOS
   brew install flyctl
   
   # 或直接下载
   curl -L https://fly.io/install.sh | sh
   ```

2. **登录并初始化**：
   ```bash
   fly auth login
   fly launch
   ```

3. **部署**：
   ```bash
   fly deploy
   ```

---

### 🥉 方案3：Koyeb

#### 特点
- ✅ **免费额度**：每月100小时
- ✅ **全球CDN**
- ✅ **GitHub集成**

#### 部署步骤
1. **访问 https://www.koyeb.com**
2. **连接GitHub**
3. **选择仓库并部署**

---

### 🏆 方案4：Vercel（有限支持）

虽然我们已经创建了Vercel配置，但由于TensorFlow模型较大，可能会遇到限制。

#### 修改建议
如果要使用Vercel，建议：
1. 使用更小的TFLite模型
2. 简化依赖项
3. 可能需要外部模型托管

---

## 🎯 立即行动建议

### 最简单的方案：Render

1. **访问 https://render.com**
2. **点击 "Get Started" 并用GitHub登录**
3. **选择 "Web Service"**
4. **连接您的仓库：`sun409377708/EmotionDetect`**
5. **使用以下配置**：
   - Build Command: `pip install -r requirements.txt`
   - Start Command: `gunicorn web_demo:app --host=0.0.0.0 --port=$PORT`
6. **点击部署**

### 如果Render也有问题，备选方案：

#### 本地Docker + ngrok（临时方案）
```bash
# 构建Docker镜像
docker build -t emotion-app .

# 运行容器
docker run -p 8080:8080 emotion-app

# 使用ngrok暴露到公网（另一个终端）
ngrok http 8080
```

---

## 📊 平台对比表

| 平台 | 免费额度 | TensorFlow支持 | 部署难度 | 推荐指数 |
|------|----------|----------------|----------|----------|
| **Render** | 750小时/月 | ✅ 完全支持 | ⭐⭐⭐⭐⭐ 很简单 | ⭐⭐⭐⭐⭐ |
| **Fly.io** | $5/月 | ✅ 完全支持 | ⭐⭐⭐⭐ 简单 | ⭐⭐⭐⭐ |
| **Koyeb** | 100小时/月 | ✅ 支持 | ⭐⭐⭐⭐ 简单 | ⭐⭐⭐ |
| **Vercel** | 100GB带宽 | ⚠️ 有限制 | ⭐⭐⭐ 中等 | ⭐⭐ |
| Railway | ❌ 需付费 | ✅ 完全支持 | ⭐⭐⭐⭐⭐ 很简单 | ❌ |

---

## 🔧 故障排除

### 如果部署失败，常见原因：

1. **内存不足**
   - 解决：使用TFLite模型而不是H5模型
   - 修改代码优先加载`emotion_model.tflite`

2. **依赖安装失败**
   - 解决：简化`requirements.txt`，移除不必要的包

3. **启动超时**
   - 解决：增加启动超时时间，或优化模型加载速度

### 简化版requirements.txt（如果遇到问题）：
```
Flask==2.3.3
tensorflow-cpu==2.13.0
opencv-python-headless==4.8.1.78
Pillow==10.0.1
numpy==1.24.3
gunicorn==21.2.0
```

---

## 🎉 推荐操作

**立即试试Render！**

1. 访问 https://render.com
2. 用GitHub登录
3. 创建Web Service
4. 连接您的EmotionDetect仓库
5. 10分钟后就能在线访问您的表情识别应用！

如果有任何部署问题，我们可以进一步优化配置。 